{"ast":null,"code":"var _jsxFileName = \"/home/com109/Desktop/ad/my-app/src/screens/timeline.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\"; // import socketIOClient from \"socket.io-client\";\n\nimport { updateLoginState, updateCategories, resetLoginState } from \"../redux/actions\";\nimport serverCall from \"../utilsFolder/utils\";\nimport { Routes, ServerUrl } from \"../config\";\nimport TimelineBodyComponent from \"../components/timeline/timelineBodyComponent\";\nimport { DownloadImage } from \"../utilsFolder/utils\";\nconst {\n  Likes_Post,\n  AllPosts,\n  UserData,\n  TotalNumberOfPosts\n} = Routes;\nconst zero = 0;\nlet username = \"\";\nlet emailId = \"\";\nlet myUploads = false; // let endpoint = ServerUrl;\n\nlet hasError = false;\n\nconst Timeline = props => {\n  const [hasMoreItems, setHasMoreItems] = useState(true);\n  const [postdata, setPostdata] = useState([]);\n  const [showPopup, setShowPopup] = useState(false);\n  const [items, setItems] = useState(zero);\n  const [totalPosts, setTotalPosts] = useState(zero);\n  useEffect(() => {\n    totalNumberPosts();\n    checkIfNotlogin();\n    props.updateLoginState(localStorage.getItem(\"userId\")); // this.setupSocket();\n\n    userDetails();\n  }, []);\n\n  const userDetails = function () {\n    let UserID = {\n      id: localStorage.getItem(\"userId\")\n    };\n    serverCall(UserData, UserID).then(res => {\n      var _res$data$zero, _res$data$zero2;\n\n      if (res && res.data) username = (_res$data$zero = res.data[zero]) === null || _res$data$zero === void 0 ? void 0 : _res$data$zero.username;\n      emailId = (_res$data$zero2 = res.data[zero]) === null || _res$data$zero2 === void 0 ? void 0 : _res$data$zero2.email;\n    });\n  };\n\n  const checkIfNotlogin = function () {\n    if (!localStorage.getItem(\"userId\")) {\n      props.history.push(\"/login\");\n    }\n  };\n\n  const totalNumberPosts = async function () {\n    const data = {\n      email: myUploads ? emailId : null\n    };\n    serverCall(TotalNumberOfPosts, data).then(res => {\n      if (res && res.data) {\n        var _res$data;\n\n        setTotalPosts((_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.counts);\n      }\n    });\n  };\n\n  const likePost = function (postID) {\n    let likedData = {\n      postId: postID,\n      userId: localStorage.getItem(\"userId\")\n    };\n    serverCall(Likes_Post, likedData).then(res => {\n      if (res === null || res === void 0 ? void 0 : res.data) {\n        var _res$data2;\n\n        let likeData = res === null || res === void 0 ? void 0 : (_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : _res$data2.dataFromDatabase[0];\n\n        for (let i = zero; i < postdata.length; i++) {\n          if (postdata[i]._id === likeData._id) {\n            let newpostData = postdata;\n            newpostData[i].likes = likeData.likes;\n            setPostdata([...newpostData]);\n          }\n        }\n      }\n    });\n  };\n\n  const stateUpdateOnTimelineClick = async () => {\n    setHasMoreItems(true);\n    setItems(zero);\n    myUploads = false;\n    await totalNumberPosts();\n    await allPost(items);\n  };\n\n  const togglePopup = () => {\n    setShowPopup(!showPopup);\n  };\n\n  const loadMorePosts = () => {\n    if (totalPosts) {\n      if (totalPosts >= items) {\n        setTimeout(async () => {\n          await allPost(items);\n        }, 1000);\n      } else {\n        setHasMoreItems(false);\n      }\n\n      return new Promise(resolve => {\n        resolve(true);\n      });\n    } else {\n      return;\n    }\n  };\n\n  const allPost = skipPosts => {\n    const post = {\n      Skip: skipPosts,\n      email: myUploads ? emailId : false\n    };\n    serverCall(AllPosts, post).then(res => {\n      if (res) {\n        var _res$data3;\n\n        let allPostsData = (_res$data3 = res.data) === null || _res$data3 === void 0 ? void 0 : _res$data3.dataFromDatabase;\n\n        if (skipPosts === zero) {\n          setPostdata(allPostsData);\n          setItems(skipPosts + 5);\n        } else {\n          setItems(skipPosts + 5);\n          setPostdata([...postdata, ...allPostsData]);\n        }\n      }\n    });\n  };\n\n  const showMyUploads = async () => {\n    setHasMoreItems(true);\n    setItems(zero);\n    myUploads = true;\n    await totalNumberPosts();\n    await allPost(items);\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, \"(\\\"\", React.createElement(TimelineBodyComponent, {\n    togglePopup: togglePopup.bind(this),\n    username: username,\n    showMyUploads: showMyUploads,\n    stateUpdateOnTimelineClick: stateUpdateOnTimelineClick,\n    items: items,\n    loadMorePosts: loadMorePosts,\n    hasMoreItems: hasMoreItems,\n    postdata: postdata,\n    likePost: likePost,\n    showPopup: showPopup,\n    hasError: hasError,\n    downLoad: DownloadImage,\n    emailId: emailId,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }));\n};\n\nfunction mapStateToProps(state) {\n  return {\n    category: state.CategoryReducer.category\n  };\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    updateLoginState: data => dispatch(updateLoginState(data)),\n    updateCategory: data => dispatch(updateCategories(data)),\n    resetLoginState: () => dispatch(resetLoginState())\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Timeline);","map":{"version":3,"sources":["/home/com109/Desktop/ad/my-app/src/screens/timeline.js"],"names":["React","useEffect","useState","connect","updateLoginState","updateCategories","resetLoginState","serverCall","Routes","ServerUrl","TimelineBodyComponent","DownloadImage","Likes_Post","AllPosts","UserData","TotalNumberOfPosts","zero","username","emailId","myUploads","hasError","Timeline","props","hasMoreItems","setHasMoreItems","postdata","setPostdata","showPopup","setShowPopup","items","setItems","totalPosts","setTotalPosts","totalNumberPosts","checkIfNotlogin","localStorage","getItem","userDetails","UserID","id","then","res","data","email","history","push","counts","likePost","postID","likedData","postId","userId","likeData","dataFromDatabase","i","length","_id","newpostData","likes","stateUpdateOnTimelineClick","allPost","togglePopup","loadMorePosts","setTimeout","Promise","resolve","skipPosts","post","Skip","allPostsData","showMyUploads","bind","mapStateToProps","state","category","CategoryReducer","mapDispatchToProps","dispatch","updateCategory"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\n// import socketIOClient from \"socket.io-client\";\n\nimport {\n  updateLoginState,\n  updateCategories,\n  resetLoginState\n} from \"../redux/actions\";\nimport serverCall from \"../utilsFolder/utils\";\nimport { Routes, ServerUrl } from \"../config\";\nimport TimelineBodyComponent from \"../components/timeline/timelineBodyComponent\";\nimport { DownloadImage } from \"../utilsFolder/utils\";\n\nconst { Likes_Post, AllPosts, UserData, TotalNumberOfPosts } = Routes;\n\nconst zero = 0;\nlet username = \"\";\nlet emailId = \"\";\nlet myUploads = false;\n// let endpoint = ServerUrl;\nlet hasError = false;\n\nconst Timeline = props => {\n  const [hasMoreItems, setHasMoreItems] = useState(true);\n  const [postdata, setPostdata] = useState([]);\n  const [showPopup, setShowPopup] = useState(false);\n  const [items, setItems] = useState(zero);\n  const [totalPosts, setTotalPosts] = useState(zero);\n\n  useEffect(() => {\n    totalNumberPosts();\n    checkIfNotlogin();\n    props.updateLoginState(localStorage.getItem(\"userId\"));\n    // this.setupSocket();\n    userDetails();\n  }, []);\n\n  const userDetails = function() {\n    let UserID = { id: localStorage.getItem(\"userId\") };\n    serverCall(UserData, UserID).then(res => {\n      if (res && res.data) username = res.data[zero]?.username;\n      emailId = res.data[zero]?.email;\n    });\n  };\n\n  const checkIfNotlogin = function() {\n    if (!localStorage.getItem(\"userId\")) {\n      props.history.push(\"/login\");\n    }\n  };\n\n  const totalNumberPosts = async function() {\n    const data = { email: myUploads ? emailId : null };\n    serverCall(TotalNumberOfPosts, data).then(res => {\n      if (res && res.data) {\n        setTotalPosts(res.data?.counts);\n      }\n    });\n  };\n\n  const likePost = function(postID) {\n    let likedData = {\n      postId: postID,\n      userId: localStorage.getItem(\"userId\")\n    };\n    serverCall(Likes_Post, likedData).then(res => {\n      if (res?.data) {\n        let likeData = res?.data?.dataFromDatabase[0];\n        for (let i = zero; i < postdata.length; i++) {\n          if (postdata[i]._id === likeData._id) {\n            let newpostData = postdata;\n            newpostData[i].likes = likeData.likes;\n            setPostdata([...newpostData]);\n          }\n        }\n      }\n    });\n  };\n\n  const stateUpdateOnTimelineClick = async () => {\n    setHasMoreItems(true);\n    setItems(zero);\n    myUploads = false;\n    await totalNumberPosts();\n    await allPost(items);\n  };\n\n  const togglePopup = () => {\n    setShowPopup(!showPopup);\n  };\n\n  const loadMorePosts = () => {\n    if (totalPosts) {\n      if (totalPosts >= items) {\n        setTimeout(async () => {\n          await allPost(items);\n        }, 1000);\n      } else {\n        setHasMoreItems(false);\n      }\n      return new Promise(resolve => {\n        resolve(true);\n      });\n    } else {\n      return;\n    }\n  };\n\n  const allPost = skipPosts => {\n    const post = {\n      Skip: skipPosts,\n      email: myUploads ? emailId : false\n    };\n    serverCall(AllPosts, post).then(res => {\n      if (res) {\n        let allPostsData = res.data?.dataFromDatabase;\n        if (skipPosts === zero) {\n          setPostdata(allPostsData);\n          setItems(skipPosts + 5);\n        } else {\n          setItems(skipPosts + 5);\n          setPostdata([...postdata, ...allPostsData]);\n        }\n      }\n    });\n  };\n\n  const showMyUploads = async () => {\n    setHasMoreItems(true);\n    setItems(zero);\n    myUploads = true;\n    await totalNumberPosts();\n    await allPost(items);\n  };\n  return (\n    <div>\n      (\"\n      <TimelineBodyComponent\n        togglePopup={togglePopup.bind(this)}\n        username={username}\n        showMyUploads={showMyUploads}\n        stateUpdateOnTimelineClick={stateUpdateOnTimelineClick}\n        items={items}\n        loadMorePosts={loadMorePosts}\n        hasMoreItems={hasMoreItems}\n        postdata={postdata}\n        likePost={likePost}\n        showPopup={showPopup}\n        hasError={hasError}\n        downLoad={DownloadImage}\n        emailId={emailId}\n      />\n    </div>\n  );\n};\n\nfunction mapStateToProps(state) {\n  return { category: state.CategoryReducer.category };\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    updateLoginState: data => dispatch(updateLoginState(data)),\n    updateCategory: data => dispatch(updateCategories(data)),\n    resetLoginState: () => dispatch(resetLoginState())\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Timeline);\n"]},"metadata":{},"sourceType":"module"}